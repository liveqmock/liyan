<?xml version="1.0" encoding="UTF-8"?>
<ViewConfig>
  <Property name="metaData">
    <Property name="securityTag">SysPostManage</Property>
  </Property>
  <Arguments/>
  <Context/>
  <Model>
    <DataType name="dataTypeSysPost" parent="global:dataTypeSysPost">
      <ClientEvent name="onDataChange">if(arg.property==&quot;postCode&quot;){
		view.get(&quot;#checkCode&quot;).set(&quot;parameter&quot;,arg.value).execute(function(result) {
		if(result==&quot;true&quot;)
		{
			arg.entity.setMessages(&quot;postCode&quot;,{ state: &quot;error&quot;, text: &quot;该岗位编号已经被使用,请重新输入!&quot; });
		}
	});
}
</ClientEvent>
      <Property name="autoCreatePropertyDefs">false</Property>
      <PropertyDef name="orgName">
        <Property name="dataType">String</Property>
        <Property name="label">部门名称</Property>
        <Property name="required">true</Property>
      </PropertyDef>
    </DataType>
    <DataType name="querydataTypeSysPost">
      <Property name="autoCreatePropertyDefs">false</Property>
      <PropertyDef name="qMpostCode">
        <Property name="dataType">String</Property>
        <Property name="defaultValue">eq</Property>
        <Property name="mapping">
          <Property name="mapValues">${dorado.getDataProvider(&quot;coderCreate#getDict&quot;).getResult(&quot;QUERY_METHOD&quot;)}</Property>
        </Property>
      </PropertyDef>
      <PropertyDef name="postCode">
        <Property name="dataType">String</Property>
        <Property name="label">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode"].propertyLabel}</Property>
      </PropertyDef>
      <PropertyDef name="qMpostName">
        <Property name="dataType">String</Property>
        <Property name="defaultValue">eq</Property>
        <Property name="mapping">
          <Property name="mapValues">${dorado.getDataProvider(&quot;coderCreate#getDict&quot;).getResult(&quot;QUERY_METHOD&quot;)}</Property>
        </Property>
      </PropertyDef>
      <PropertyDef name="postName">
        <Property name="dataType">String</Property>
        <Property name="label">${req["com.innofi.component.rbac.post.pojo.SysPost.postName"].propertyLabel}</Property>
      </PropertyDef>
      <PropertyDef name="orgCode">
        <Property name="dataType">String</Property>
      </PropertyDef>
    </DataType>
    <DataType name="OrgInfo" parent="dataTypeSysOrgInfo">
      <Property name="acceptValidationState">warn</Property>
      <Reference name="children">
        <Property name="dataType">[SELF]</Property>
        <Property name="dataProvider">sysOrgInfoAction#findSysOrgInfoTreeForPolicy</Property>
        <Property name="parameter">
          <Entity>
            <Property name="parentOrgId">$${this.id}</Property>
          </Entity>
        </Property>
      </Reference>
      <PropertyDef name="hasChild">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="policyFlag">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
      <PropertyDef name="parentOrgName">
        <Property name="dataType">String</Property>
        <Property name="label">父机构名称</Property>
      </PropertyDef>
    </DataType>
    <DataType name="dataTypeSysUser" parent="global:dataTypeSysUser">
      <Property name="autoCreatePropertyDefs">false</Property>
      <PropertyDef name="orgName">
        <Property name="label">部门名称</Property>
      </PropertyDef>
      <PropertyDef name="selectFlag">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
    </DataType>
    <DataType name="dataTypeSysUserPost" parent="global:dataTypeSysUserPost">
      <PropertyDef name="userName">
        <Property name="dataType">String</Property>
        <Property name="label">用户名称</Property>
      </PropertyDef>
      <PropertyDef name="orgName">
        <Property name="dataType">String</Property>
        <Property name="label">部门名称</Property>
      </PropertyDef>
    </DataType>
    <DataType name="dataTypeSysUserQuery">
      <Property name="autoCreatePropertyDefs">false</Property>
      <PropertyDef name="userName">
        <Property name="label">用户名称</Property>
      </PropertyDef>
    </DataType>
    <DataType name="postRole" parent="global:dataTypeSysPostRole" meta="x:330;y:390">
      <PropertyDef name="roleName">
        <Property name="dataType">String</Property>
        <Property name="label">角色名称</Property>
      </PropertyDef>
      <PropertyDef name="roleType">
        <Property name="dataType">String</Property>
        <Property name="label">角色类型</Property>
        <Property name="mapping">
          <Property name="mapValues">${dorado.getDataProvider(&quot;coderCreate#getDict&quot;).getResult(&quot;ROLE_TYPE&quot;)}</Property>
        </Property>
      </PropertyDef>
      <PropertyDef name="status">
        <Property name="dataType">String</Property>
        <Property name="mapping">
          <Property name="mapValues">${dorado.getDataProvider(&quot;coderCreate#getDict&quot;).getResult(&quot;COMM_STATUS&quot;)}</Property>
        </Property>
        <Property name="label">状态</Property>
      </PropertyDef>
    </DataType>
    <DataType name="sysRole" parent="dataTypeSysRole">
      <PropertyDef name="selectFlag">
        <Property name="dataType">boolean</Property>
      </PropertyDef>
    </DataType>
    <DataType name="dataTypeRoleQuery">
      <PropertyDef name="roleName">
        <Property name="dataType">String</Property>
        <Property name="label">角色名称</Property>
      </PropertyDef>
    </DataType>
    <DataType name="postBusiness" parent="dataTypeSysObjBusiness">
      <PropertyDef name="busilineName">
        <Property name="label">业务条线名称</Property>
      </PropertyDef>
    </DataType>
    <DataType name="dataTypeSysBusinessLine" parent="global:dataTypeSysBusinessLine">
      <Property name="autoCreatePropertyDefs">false</Property>
      <Reference name="children">
        <Property name="dataType">[SELF]</Property>
        <Property name="dataProvider">sysBusinessLineAction#findSysBusinessLineByParentId</Property>
        <Property name="parameter">$${this.id}</Property>
      </Reference>
      <PropertyDef name="busilineBaselName">
        <Property name="label">Basel业务条线</Property>
        <Property name="dataType">String</Property>
      </PropertyDef>
      <PropertyDef name="belongOrgName">
        <Property name="dataType">String</Property>
        <Property name="label">管理部门</Property>
      </PropertyDef>
    </DataType>
  </Model>
  <View>
    <Property name="packages">validator</Property>
    <DataSet id="dataSetOrg">
      <Property name="dataType">[OrgInfo]</Property>
      <Property name="dataProvider">sysOrgInfoAction#findSysOrgInfoTreeForPolicy</Property>
      <Property name="parameter">
        <Entity>
          <Property name="parentOrgId">${sys.getString(&quot;mdf.orgRoot&quot;)}</Property>
        </Entity>
      </Property>
    </DataSet>
    <DataSet id="dataSetSysPost">
      <Property name="dataProvider">sysPostAction#findSysPosts</Property>
      <Property name="dataType">[dataTypeSysPost]</Property>
      <Property name="pageSize">${sys.getLong(&quot;mdf.default.pagesize&quot;)}</Property>
      <Property name="loadMode">manual</Property>
    </DataSet>
    <DataSet id="querydataSetSysPost">
      <ClientEvent name="onReady">self.insert({});</ClientEvent>
      <Property name="dataType">[querydataTypeSysPost]</Property>
    </DataSet>
    <DataSet id="dataSetUserPost">
      <Property name="dataType">[dataTypeSysUserPost]</Property>
      <Property name="dataProvider">sysUserPostAction#findUsersByMainPostId</Property>
      <Property name="loadMode">manual</Property>
    </DataSet>
    <DataSet id="dataSetUser">
      <Property name="dataType">[dataTypeSysUser]</Property>
      <Property name="dataProvider">sysUserPostAction#findSysUserByPostId</Property>
      <Property name="pageSize">10</Property>
      <Property name="loadMode">manual</Property>
    </DataSet>
    <DataSet id="dataSetUserQuery">
      <ClientEvent name="onReady">self.insert({});</ClientEvent>
      <Property name="dataType">dataTypeSysUserQuery</Property>
    </DataSet>
    <DataSet id="dataSetPostRole">
      <Property name="loadMode">manual</Property>
      <Property name="dataProvider">sysPostRoleAction#findSysPostRoleByPostId</Property>
      <Property name="dataType">[postRole]</Property>
    </DataSet>
    <DataSet id="dataSetRole">
      <Property name="dataType">[sysRole]</Property>
      <Property name="loadMode">manual</Property>
      <Property name="dataProvider">sysPostRoleAction#findSysRoleByPostId</Property>
      <Property name="pageSize">10</Property>
    </DataSet>
    <DataSet id="dataSetRoleQuery">
      <ClientEvent name="onReady">self.insert({});</ClientEvent>
      <Property name="dataType">dataTypeRoleQuery</Property>
    </DataSet>
    <DataSet id="dataSetPostBusiness">
      <Property name="loadMode">manual</Property>
      <Property name="dataProvider">sysObjBusinessAction#findSysObjBusinesss</Property>
      <Property name="dataType">[postBusiness]</Property>
      <Property name="pageSize">${sys.getLong(&quot;mdf.default.pagesize&quot;)}</Property>
    </DataSet>
    <DataSet id="dataSetBizLine">
      <Property name="loadMode">manual</Property>
      <Property name="dataProvider">sysBusinessLineAction#findSysBusinessLines</Property>
      <Property name="dataType">[dataTypeSysBusinessLine]</Property>
      <Property name="pageSize">${sys.getLong(&quot;mdf.default.pagesize&quot;)}</Property>
    </DataSet>
    <SplitPanel>
      <Property name="position">200</Property>
      <MainControl>
        <Container>
          <FieldSet layoutConstraint="top">
            <Property name="caption">查询条件</Property>
            <Property name="collapsed">false</Property>
            <Buttons>
              <Button id="queryButton">
                <ClientEvent name="onClick">var currentNode = view.get(&quot;#orgTree&quot;).get(&quot;currentNode&quot;);
if (!currentNode) {
	
}else{
	var currentEntity = currentNode.get(&quot;data&quot;);
	var orgCode=currentEntity.get(&quot;orgCode&quot;);
	var parentId=currentEntity.get(&quot;parentOrgId&quot;);//判断是否为根节点
	if(orgCode!=&quot;&quot; &amp;&amp; parentId!=&quot;0&quot;){
		view.get(&quot;#querydataSetSysPost&quot;).getData(&quot;#&quot;).set(&quot;orgCode&quot;,orgCode);
	}
}
view.get(&quot;#dataSetSysPost&quot;).set(&quot;parameter&quot;, view.get(&quot;#querydataSetSysPost&quot;).getData(&quot;#&quot;)).flushAsync();
</ClientEvent>
                <Property name="caption">查询</Property>
                <Property name="icon">url(>skin>common/icons.gif) -40px -100px</Property>
              </Button>
              <Button id="resetButton">
                <ClientEvent name="onClick">var entity = view.get(&quot;#querydataSetSysPost&quot;).getData(&quot;#&quot;);
with (entity){
 set(&quot;postCode&quot;,&quot;&quot;);
 set(&quot;postName&quot;,&quot;&quot;);
};
</ClientEvent>
                <Property name="icon">url(>skin>common/icons.gif) -280px -220px</Property>
                <Property name="caption">重置</Property>
              </Button>
            </Buttons>
            <Children>
              <AutoForm id="autoFormSysPostQuery" layoutConstraint="center">
                <Property name="cols">*,*</Property>
                <Property name="dataSet">querydataSetSysPost</Property>
                <Property name="dataType">querydataTypeSysPost</Property>
                <Property name="labelAlign">right</Property>
                <Property name="labelWidth">120</Property>
                <AutoFormElement name="autoFormElementpostCode">
                  <Property name="name">postCode</Property>
                  <Property name="property">postCode</Property>
                  <Editor>
                    <Container>
                      <TextEditor layoutConstraint="left">
                        <Property name="property">qMpostCode</Property>
                        <Property name="trigger">autoMappingDropDown1</Property>
                        <Property name="dataSet">querydataSetSysPost</Property>
                        <Property name="width">60</Property>
                      </TextEditor>
                      <TextEditor>
                        <Property name="property">postCode</Property>
                        <Property name="dataSet">querydataSetSysPost</Property>
                        <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyBlankText}</Property>
                        <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyTip}</Property>
                      </TextEditor>
                    </Container>
                  </Editor>
                </AutoFormElement>
                <AutoFormElement name="autoFormElementpostName">
                  <Property name="name">postName</Property>
                  <Property name="property">postName</Property>
                  <Editor>
                    <Container>
                      <TextEditor layoutConstraint="left">
                        <Property name="property">qMpostName</Property>
                        <Property name="trigger">autoMappingDropDown1</Property>
                        <Property name="dataSet">querydataSetSysPost</Property>
                        <Property name="width">60</Property>
                      </TextEditor>
                      <TextEditor>
                        <Property name="property">postName</Property>
                        <Property name="dataSet">querydataSetSysPost</Property>
                        <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyBlankText}</Property>
                        <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyTip}</Property>
                      </TextEditor>
                    </Container>
                  </Editor>
                </AutoFormElement>
              </AutoForm>
            </Children>
          </FieldSet>
          <ToolBar id="toolBarSysPost" layoutConstraint="top">
            <Property name="tags">tags_toolbar</Property>
            <ToolBarButton id="addButton">
              <ClientEvent name="onClick">var nodeEntity=view.get(&quot;#orgTree&quot;).get(&quot;currentNode&quot;).get(&quot;data&quot;);
if(nodeEntity.get(&quot;parentOrgId&quot;)==&quot;0&quot;){
	dorado.MessageBox.alert(&quot;根节点不允许添加岗位！&quot;);
}else if(nodeEntity.get(&quot;category&quot;)==&quot;1&quot;){
	dorado.MessageBox.alert(&quot;机构节点不允许添加岗位！&quot;);
}else{
	view.get(&quot;#dataSetSysPost&quot;).set(&quot;readOnly&quot;,false);
	view.get(&quot;#dataSetSysPost.data&quot;).insert();
	var entity=view.get(&quot;#dataSetSysPost&quot;).getData(&quot;#&quot;);
	with(entity){
		set(&quot;orgName&quot;,nodeEntity.get(&quot;orgName&quot;));
		set(&quot;orgCode&quot;,nodeEntity.get(&quot;orgCode&quot;));
		set(&quot;status&quot;,&quot;1&quot;);
		set(&quot;postLevel&quot;,nodeEntity.get(&quot;orgLevel&quot;));
	}
	view.get(&quot;#addDialogSysPost&quot;).show();
}
        </ClientEvent>
              <Property name="icon">url(>skin>common/icons.gif) -120px -0px</Property>
              <Property name="caption">添加</Property>
            </ToolBarButton>
            <ToolBarButton id="updateButton">
              <ClientEvent name="onClick">
          
var entitys = view.get(&quot;#dataSetSysPost&quot;).getData();
var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);


if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1)
{
	dorado.MessageBox.alert(&quot;只能选择一条记录查看修改！&quot;);
}
else if (selection.length == 1) {
	
 view.get(&quot;#dataSetSysPost&quot;).getData().setCurrent(selection[0]);
view.get(&quot;#dialogSysPost&quot;).show();
view.get(&quot;#dataSetSysPost&quot;).set(&quot;readOnly&quot;,false);
}

         </ClientEvent>
              <Property name="caption">修改</Property>
              <Property name="icon">url(>skin>common/icons.gif) -200px -0px</Property>
            </ToolBarButton>
            <ToolBarButton id="delButton">
              <ClientEvent name="onClick">var entitys = view.get(&quot;#dataSetSysPost&quot;).getData();
var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var action = view.get(&quot;#saveSysPostsAction&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if(selection.length>1){
	dorado.MessageBox.alert(&quot;请选择一条记录进行停用！&quot;);
}else{
	var entity=selection[0];
	var action=view.get(&quot;#delAction&quot;);
	dorado.MessageBox.confirm(&quot;确定停用？&quot;, function(){
		action.set(&quot;parameter&quot;,entity.get(&quot;id&quot;)).execute(function(result){
			if(result==&quot;ok&quot;){
				view.get(&quot;#dataSetSysPost&quot;).get(&quot;dataType&quot;).set(&quot;acceptValidationState&quot;,&quot;error&quot;);
				entity.set(&quot;status&quot;,&quot;0&quot;);
				view.get(&quot;#saveSysPostsAction&quot;).execute();
				view.get(&quot;#dataSetSysPost&quot;).get(&quot;dataType&quot;).set(&quot;acceptValidationState&quot;,&quot;warn&quot;);
			}else if(result==&quot;user&quot;){
				alert(&quot;操作失败，该岗位下存在状态为有效的用户，请先将用户停用或在用户管理中将该岗位删除，再尝试执行此操作！&quot;);
			}
		});
	});
}</ClientEvent>
              <Property name="caption">停用</Property>
              <Property name="icon">url(>skin>common/icons.gif) -140px -0px</Property>
            </ToolBarButton>
            <ToolBarButton id="addUserButton">
              <ClientEvent name="onClick">
          
var entitys = view.get(&quot;#dataSetSysPost&quot;).getData();
var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);


if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1)
{
	dorado.MessageBox.alert(&quot;只能选择一条记添加主岗用户！&quot;);
}
else if (selection.length == 1) {
	var postId=selection[0].get(&quot;id&quot;);
	view.get(&quot;#dataSetUserPost&quot;).set(&quot;parameter&quot;,postId).flushAsync();
	view.get(&quot;#addDialogSysUserPost&quot;).show();
}

         </ClientEvent>
              <Property name="caption">添加用户</Property>
              <Property name="icon">>icons/user.png</Property>
            </ToolBarButton>
            <ToolBarButton id="lookButton">
              <ClientEvent name="onClick">
var entitys = view.get(&quot;#dataSetSysPost&quot;).getData();
var found = false;
var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1)
{
	dorado.MessageBox.alert(&quot;只能查看一条记录！&quot;);
}
else if (selection.length == 1) {
 view.get(&quot;#dataSetSysPost&quot;).getData().setCurrent(selection[0]);
view.get(&quot;#lookdialogSysPost&quot;).show();
view.get(&quot;#dataSetSysPost&quot;).set(&quot;readOnly&quot;,true);
}


</ClientEvent>
              <Property name="caption">查看</Property>
              <Property name="icon">url(>skin>common/icons.gif) -120px -120px</Property>
            </ToolBarButton>
            <ToolBarButton id="addRoleButton">
              <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1)
{
	dorado.MessageBox.alert(&quot;只能对一条记录添加角色！&quot;);
}
else if (selection.length == 1) {
  var postId = selection[0].get(&quot;id&quot;);
  //alert(&quot;postId&quot;+postId);
  view.get(&quot;#dataSetPostRole&quot;).set(&quot;parameter&quot;,postId).flushAsync();
  view.get(&quot;#addDialogSysPostRole&quot;).show();
}

</ClientEvent>
              <Property name="caption">添加角色</Property>
              <Property name="icon">>icons/user_orange.png</Property>
            </ToolBarButton>
            <ToolBarButton id="addBusinessButton">
              <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1){
	dorado.MessageBox.alert(&quot;只能对一条记录维护业务条线！&quot;);
}
else if (selection.length == 1) {
  var postId = selection[0].get(&quot;id&quot;);
  var objBusilineType = &quot;2&quot;;
  view.get(&quot;#dataSetPostBusiness&quot;).set(&quot;parameter&quot;,{
  	objId:postId,
	objBusilineType:objBusilineType
  }).flushAsync();
  view.get(&quot;#addDialogSysPostBusiness&quot;).show();
}

</ClientEvent>
              <Property name="caption">维护业务条线</Property>
              <Property name="icon">>icons/layers.png</Property>
              <Property name="ignored">${sys.getString(&quot;mdf.sysuser.bizline.pattern&quot;) ne &quot;2&quot;}</Property>
            </ToolBarButton>
          </ToolBar>
          <Container>
            <DataGrid id="dataGridSysPost" layoutConstraint="center">
              <ClientEvent name="onDataRowClick">/*var newSelection = [];
var selection = self.get(&quot;selection&quot;);
var entity = view.get(&quot;#dataSetSysPost&quot;).getData(&quot;#&quot;);
var found = false;
selection.each(function(data){
	if (data.get(&quot;id&quot;) == entity.get(&quot;id&quot;)) {
		found = true;
	}else{
		newSelection.push(data);
	}
});

if (!found) {
	newSelection.push(entity);
}
self.set(&quot;selection&quot;, newSelection);*/</ClientEvent>
              <ClientEvent name="onSelectionChange">
if (arg.added) 
{
 view.get(&quot;#dataSetSysPost&quot;).getData().setCurrent(arg.added[0])
}
</ClientEvent>
              <Property name="dataSet">dataSetSysPost</Property>
              <Property name="selectionMode">multiRows</Property>
              <Property name="readOnly">true</Property>
              <Property name="dataType">dataTypeSysPost</Property>
              <Property name="rowHeight">26</Property>
              <Property name="height">100%</Property>
              <Property name="width">100%</Property>
              <Property name="highlightCurrentRow">false</Property>
              <Property name="stretchColumnsMode">stretchableColumns</Property>
              <RowNumColumn/>
              <RowSelectorColumn/>
              <DataColumn name="postCode" property="postCode"/>
              <DataColumn name="postName" property="postName"/>
              <DataColumn>
                <Property name="name">orgName</Property>
                <Property name="property">orgName</Property>
                <Editor/>
              </DataColumn>
              <DataColumn name="postLevel" property="postLevel"/>
              <DataColumn name="postCate" property="postCate"/>
              <DataColumn name="status" property="status"/>
              <DataColumn name="postDesc" property="postDesc"/>
            </DataGrid>
          </Container>
          <ToolBar layoutConstraint="bottom">
            <DataPilot>
              <Property name="dataSet">dataSetSysPost</Property>
              <Property name="itemCodes">pages</Property>
            </DataPilot>
            <Separator/>
          </ToolBar>
        </Container>
      </MainControl>
      <SideControl>
        <DataTree id="orgTree">
          <ClientEvent name="onDataRowClick">var node = self.get(&quot;currentNode&quot;);
var orgCode=node.get(&quot;data&quot;).get(&quot;orgCode&quot;);
var parentId=node.get(&quot;data&quot;).get(&quot;parentOrgId&quot;);//判断是否为根节点
var policyFlag=node.get(&quot;data&quot;).get(&quot;policyFlag&quot;);

if(!policyFlag){
	dorado.MessageBox.alert(&quot;没有权限查看该机构下的数据！&quot;);	
	return;
}	
	//只对策略的部分数据显示
	var entity = view.get(&quot;#querydataSetSysPost&quot;).getData(&quot;#&quot;);
	with (entity){
 	set(&quot;postCode&quot;,&quot;&quot;);
 	set(&quot;postName&quot;,&quot;&quot;);
 	set(&quot;orgCode&quot;,&quot;&quot;);
	};
	if(parentId!=&quot;0&quot;){
		entity.set(&quot;orgCode&quot;,orgCode);
	}
	view.get(&quot;#dataSetSysPost&quot;).set(&quot;parameter&quot;, entity).flushAsync();

</ClientEvent>
          <ClientEvent name="onNodeCheckedChange">if(!arg.node.get('checked')){&#xD;
	arg.node.set('checked',true);&#xD;
}</ClientEvent>
          <ClientEvent name="onNodeAttached">var node = arg.node;&#xD;
var entity = node.get('data');&#xD;
if(entity.get('policyFlag')){&#xD;
	node.set('checkable',true);&#xD;
	node.set('checked',true);	&#xD;
}</ClientEvent>
          <Property name="dataSet">dataSetOrg</Property>
          <Property name="currentNodeDataPath">CURRENT_ORG</Property>
          <Property name="selectionMode">multiRows</Property>
          <BindingConfigs>
            <BindingConfig>
              <Property name="autoCheckChildren">false</Property>
              <Property name="expandLevel">1</Property>
              <Property name="childrenProperty">children</Property>
              <Property name="labelProperty">orgName</Property>
              <Property name="recursive">true</Property>
              <Property name="expandedIcon">>icons/branch_element.png</Property>
              <Property name="icon">>icons/branch_element.png</Property>
            </BindingConfig>
          </BindingConfigs>
        </DataTree>
      </SideControl>
    </SplitPanel>
    <UpdateAction id="saveSysPostsAction">
      <Property name="executingMessage">正在处理...</Property>
      <Property name="successMessage">操作成功</Property>
      <Property name="dataResolver">sysPostAction#saveSysPosts</Property>
      <UpdateItem>
        <Property name="dataSet">dataSetSysPost</Property>
      </UpdateItem>
    </UpdateAction>
    <UpdateAction id="saveUserPostAction">
      <Property name="executingMessage">正在处理...</Property>
      <Property name="successMessage">操作成功</Property>
      <Property name="dataResolver">sysUserPostAction#saveSysUserPosts</Property>
      <Property name="async">true</Property>
      <Property name="modal">false</Property>
      <UpdateItem>
        <Property name="dataSet">dataSetUserPost</Property>
      </UpdateItem>
    </UpdateAction>
    <UpdateAction id="savePostRoleAction">
      <Property name="executingMessage">正在处理...</Property>
      <Property name="successMessage">操作成功</Property>
      <Property name="dataResolver">sysPostRoleAction#saveSysPostAddRoles</Property>
      <Property name="async">true</Property>
      <Property name="modal">false</Property>
      <UpdateItem>
        <Property name="dataSet">dataSetPostRole</Property>
      </UpdateItem>
    </UpdateAction>
    <Dialog id="dialogSysPost">
      <ClientEvent name="onClose">
     view.get(&quot;#dataSetSysPost&quot;).getData().cancel();
	view.get(&quot;#dialogSysPost&quot;).hide();
     </ClientEvent>
      <Property name="caption">信息编辑</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">60%</Property>
      <Property name="height">80%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">

var action = view.get(&quot;#saveSysPostsAction&quot;);
			var dialog=view.get(&quot;#dialogSysPost&quot;);
				action.execute(function(){
					dialog.hide();
				});</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">      
          
          view.get(&quot;#dataSetSysPost&quot;).getData().cancel();
		view.get(&quot;#dialogSysPost&quot;).hide();
              	
		  </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <AutoForm id="autoFormSysPost">
          <Property name="dataType">dataTypeSysPost</Property>
          <Property name="dataSet">dataSetSysPost</Property>
          <Property name="labelAlign">right</Property>
          <Property name="hideMode">visibility</Property>
          <AutoFormElement>
            <Property name="name">postCode</Property>
            <Property name="property">postCode</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postName</Property>
            <Property name="property">postName</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postLevel</Property>
            <Property name="property">postLevel</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postCate</Property>
            <Property name="property">postCate</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">orgName</Property>
            <Property name="property">orgName</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Property name="trigger">depSingleDropDown</Property>
            <Property name="userData">
              <Entity>
                <Property name="level">postLevel</Property>
                <Property name="code">orgCode</Property>
              </Entity>
            </Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.orgCode&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.orgCode&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">status</Property>
            <Property name="property">status</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement layoutConstraint="colSpan:2">
            <Property name="name">postDesc</Property>
            <Property name="property">postDesc</Property>
            <Property name="hideMode">display</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextArea>
                <Property name="blankText">${req[&quot;postDesc&quot;].propertyBlankText}</Property>
                <Property name="tip">${req[&quot;postDesc&quot;].propertyTip}</Property>
                <Property name="height">80</Property>
              </TextArea>
            </Editor>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="addDialogSysPost">
      <ClientEvent name="onClose">
     view.get(&quot;#dataSetSysPost&quot;).getData().cancel();
	view.get(&quot;#dialogSysPost&quot;).hide();
     </ClientEvent>
      <Property name="caption">新增信息</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">60%</Property>
      <Property name="height">80%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">

var action = view.get(&quot;#saveSysPostsAction&quot;);
			var dialog=view.get(&quot;#addDialogSysPost&quot;);
				action.execute(function(){
					dialog.hide();
				});</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">      
          
          view.get(&quot;#dataSetSysPost&quot;).getData().cancel();
		view.get(&quot;#addDialogSysPost&quot;).hide();
              	
		  </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <AutoForm id="addAutoFormSysPost">
          <Property name="dataType">dataTypeSysPost</Property>
          <Property name="dataSet">dataSetSysPost</Property>
          <Property name="labelAlign">right</Property>
          <Property name="hideMode">visibility</Property>
          <AutoFormElement>
            <Property name="name">postCode</Property>
            <Property name="property">postCode</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postCode&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postName</Property>
            <Property name="property">postName</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.postName&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postLevel</Property>
            <Property name="property">postLevel</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">true</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postCate</Property>
            <Property name="property">postCate</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">orgName</Property>
            <Property name="property">orgName</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Property name="trigger">depSingleDropDown</Property>
            <Property name="userData">
              <Entity>
                <Property name="code">orgCode</Property>
              </Entity>
            </Property>
            <Editor>
              <TextEditor>
                <Property name="blankText">${req["com.innofi.component.rbac.post.pojo.SysPost.orgCode&quot;].propertyBlankText}</Property>
                <Property name="tip">${req["com.innofi.component.rbac.post.pojo.SysPost.orgCode&quot;].propertyTip}</Property>
              </TextEditor>
            </Editor>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">status</Property>
            <Property name="property">status</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement layoutConstraint="colSpan:2">
            <Property name="name">postDesc</Property>
            <Property name="property">postDesc</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextArea>
                <Property name="blankText">${req[&quot;postDesc&quot;].propertyBlankText}</Property>
                <Property name="tip">${req[&quot;postDesc&quot;].propertyTip}</Property>
                <Property name="height">80</Property>
              </TextArea>
            </Editor>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="lookdialogSysPost">
      <ClientEvent name="onClose">
     view.get(&quot;#dataSetSysPost&quot;).getData().cancel();
	view.get(&quot;#lookdialogSysPost&quot;).hide();
     </ClientEvent>
      <Property name="caption">信息查看</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="height">80%</Property>
      <Property name="width">60%</Property>
      <Buttons/>
      <Children>
        <AutoForm id="lookFormSysPost">
          <Property name="dataType">dataTypeSysPost</Property>
          <Property name="dataSet">dataSetSysPost</Property>
          <Property name="labelAlign">right</Property>
          <Property name="hideMode">visibility</Property>
          <Property name="autoCreateElements">false</Property>
          <AutoFormElement>
            <Property name="name">postCode</Property>
            <Property name="property">postCode</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postName</Property>
            <Property name="property">postName</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">orgName</Property>
            <Property name="property">orgName</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postLevel</Property>
            <Property name="property">postLevel</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">postCate</Property>
            <Property name="property">postCate</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement>
            <Property name="name">status</Property>
            <Property name="property">status</Property>
            <Editor/>
          </AutoFormElement>
          <AutoFormElement layoutConstraint="colSpan:2">
            <Property name="name">postDesc</Property>
            <Property name="property">postDesc</Property>
            <Property name="hideMode">display</Property>
            <Property name="labelAlign">right</Property>
            <Property name="readOnly">false</Property>
            <Editor>
              <TextArea>
                <Property name="blankText">${req[&quot;postDesc&quot;].propertyBlankText}</Property>
                <Property name="tip">${req[&quot;postDesc&quot;].propertyTip}</Property>
                <Property name="height">80</Property>
              </TextArea>
            </Editor>
          </AutoFormElement>
        </AutoForm>
      </Children>
      <Tools/>
    </Dialog>
    <CustomDropDown id="depSingleDropDown">
      <ClientEvent name="onClose">	if(arg.selectedValue){
		var entity = new dorado.Entity();
		entity.fromJSON(JSON.parse(arg.selectedValue));
		var dataSet=self.get(&quot;editor&quot;).get(&quot;parent&quot;).get(&quot;dataSet&quot;);
		var name=self.get(&quot;editor&quot;).get(&quot;parent&quot;).get(&quot;property&quot;);
		var code=self.get(&quot;editor&quot;).get(&quot;parent&quot;).get(&quot;userData.code&quot;);
		//var level=self.get(&quot;editor&quot;).get(&quot;parent&quot;).get(&quot;userData.level&quot;);
		//alert(code+level);
		dataSet.getData(&quot;#&quot;).set(code,entity.get(&quot;orgCode&quot;));
		dataSet.getData(&quot;#&quot;).set(name,entity.get(&quot;orgName&quot;));
		dataSet.getData(&quot;#&quot;).set('postLevel',entity.get(&quot;orgLevel&quot;));
		dataSet.notifyObservers();
	}
	arg.selectedValue = undefined;
	return false;</ClientEvent>
      <Property name="height">300</Property>
      <Property name="autoOpen">true</Property>
      <Property name="editable">false</Property>
      <IFrame>
        <Property name="path">${request.contextPath}/com/innofi/module/commons/view/dropdown/OrgSelect.d?selectType=singleTree&amp;category=0&amp;dropdown=depSingleDropDown</Property>
      </IFrame>
    </CustomDropDown>
    <Dialog id="addDialogSysUserPost">
      <ClientEvent name="onClose">view.get(&quot;#dataSetUserPost&quot;).getData().cancel();
view.get(&quot;#addDialogSysUserPost&quot;).hide();</ClientEvent>
      <Property name="caption">添加主岗人员</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">80%</Property>
      <Property name="height">90%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var action = view.get(&quot;#saveUserPostAction&quot;);
var dialog=view.get(&quot;#addDialogSysUserPost&quot;);
action.execute();
dialog.hide();</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">view.get(&quot;#dataSetUserPost&quot;).getData().cancel();
view.get(&quot;#addDialogSysUserPost&quot;).hide();
              	
		  </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <Container>
          <ToolBar id="addUserPost">
            <ToolBarButton>
              <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var postId=selection[0].get(&quot;id&quot;);
var orgCode=selection[0].get(&quot;orgCode&quot;);
view.get(&quot;#dataSetUser&quot;).set(&quot;parameter&quot;,{postId:postId,orgCode:orgCode}).flushAsync();
view.get(&quot;#dialogUser&quot;).show();
</ClientEvent>
              <Property name="caption">添加</Property>
              <Property name="icon">url(>skin>common/icons.gif) -120px -0px</Property>
            </ToolBarButton>
            <ToolBarButton>
              <ClientEvent name="onClick">var entitys = view.get(&quot;#dataSetUserPost&quot;).getData();
var selection = view.get(&quot;#userPostGrid&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if (selection.length != 0) {
			jQuery.each(selection,function(i,item){
			entitys.remove(item);
		});
}</ClientEvent>
              <Property name="caption">删除</Property>
              <Property name="icon">url(>skin>common/icons.gif) -140px -0px</Property>
            </ToolBarButton>
          </ToolBar>
          <DataGrid id="userPostGrid">
            <Property name="dataSet">dataSetUserPost</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="readOnly">true</Property>
            <RowNumColumn/>
            <RowSelectorColumn/>
            <DataColumn>
              <Property name="name">userName</Property>
              <Property name="property">userName</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="name">orgName</Property>
              <Property name="property">orgName</Property>
              <Editor/>
            </DataColumn>
          </DataGrid>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="dialogUser">
      <Property name="caption">用户选择</Property>
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">70%</Property>
      <Property name="height">90%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var dialog = view.get(&quot;#dialogUser&quot;);
var entitys = view.get(&quot;#dataSetUserPost&quot;).getData();
var selection = view.get(&quot;#userMultiList&quot;).get(&quot;selection&quot;);
var currPost = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var postId=currPost[0].get(&quot;id&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if (selection.length != 0) {
	jQuery.each(selection,function(i,item){
		//忽略已经存在的按钮
		var bool = true;
		entitys.each(function(entity){
			if(item.get(&quot;id&quot;) == entity.get(&quot;userId&quot;)){
				bool = false;
				return true;
			}
		});
		if(bool){
			var entity = {
				userId:item.get(&quot;id&quot;),
				postId:postId,
				postType:&quot;1&quot;,
				userName:item.get(&quot;userName&quot;),
				orgName:item.get(&quot;orgName&quot;)
			};
			entitys.insert(entity);
		}
	});
	dialog.hide();
}</ClientEvent>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
          <Property name="caption">确定</Property>
        </Button>
      </Buttons>
      <Children>
        <Container id="multiList">
          <Property name="hideMode">display</Property>
          <Property name="visible">true</Property>
          <FieldSet>
            <Property name="collapsed">true</Property>
            <Property name="buttonAlign">right</Property>
            <Property name="caption">查询</Property>
            <Buttons/>
            <Children>
              <AutoForm>
                <Property name="dataSet">dataSetUserQuery</Property>
                <Property name="cols">*,*</Property>
                <Property name="labelAlign">right</Property>
                <AutoFormElement>
                  <Property name="name">userName</Property>
                  <Property name="property">userName</Property>
                  <Property name="showLabel">true</Property>
                  <Property name="trigger">triggerClear</Property>
                  <Editor/>
                </AutoFormElement>
                <Button id="postMultiListSearch">
                  <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var postId=selection[0].get(&quot;id&quot;);
var orgCode=selection[0].get(&quot;orgCode&quot;);
var userName=view.get(&quot;#dataSetUserQuery&quot;).getData(&quot;#&quot;).get(&quot;userName&quot;);
view.get(&quot;#dataSetUser&quot;).set(&quot;parameter&quot;, {&quot;postId&quot;:postId,&quot;userName&quot;:userName,&quot;orgCode&quot;:orgCode}).flushAsync();
</ClientEvent>
                  <Property name="caption">查询</Property>
                </Button>
              </AutoForm>
            </Children>
          </FieldSet>
          <DataGrid id="userMultiList">
            <Property name="dataSet">dataSetUser</Property>
            <Property name="showHeader">true</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="rowSelectionProperty">selectFlag</Property>
            <Property name="highlightCurrentRow">false</Property>
            <RowNumColumn/>
            <RowSelectorColumn/>
            <DataColumn>
              <Property name="name">userName</Property>
              <Property name="property">userName</Property>
              <Property name="readOnly">true</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="name">orgName</Property>
              <Property name="property">orgName</Property>
              <Property name="readOnly">true</Property>
              <Editor/>
            </DataColumn>
          </DataGrid>
          <ToolBar id="multiListPilot" layoutConstraint="bottom">
            <Property name="hideMode">display</Property>
            <DataPilot>
              <Property name="itemCodes">pages</Property>
              <Property name="dataSet">dataSetUser</Property>
            </DataPilot>
          </ToolBar>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="addDialogSysPostRole">
      <ClientEvent name="onClose">view.get(&quot;#dataTypeSysUserPost&quot;).getData().cancel();
view.get(&quot;#addDialogSysPostRole&quot;).hide();</ClientEvent>
      <Property name="caption">添加角色</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">80%</Property>
      <Property name="height">90%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var action = view.get(&quot;#savePostRoleAction&quot;);
var dialog=view.get(&quot;#addDialogSysPostRole&quot;);
action.execute();
dialog.hide();</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">view.get(&quot;#dataSetPostRole&quot;).getData().cancel();
view.get(&quot;#addDialogSysPostRole&quot;).hide();
              	
		  </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <Container>
          <Property name="contentOverflowY">auto</Property>
          <ToolBar id="addPostRole">
            <ToolBarButton>
              <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var currentNode = view.get(&quot;#orgTree&quot;).get(&quot;currentNode&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}
else if(selection.length>1)
{
	dorado.MessageBox.alert(&quot;只能对一条记录添加角色！&quot;);
}
else if (selection.length == 1) {
  var postId = selection[0].get(&quot;id&quot;);
  //var orgLevel = currentNode.get(&quot;data&quot;).get(&quot;orgLevel&quot;);
  var orgCode = selection[0].get(&quot;orgCode&quot;);
  view.get(&quot;#dataSetRole&quot;).set(&quot;parameter&quot;,{postId:postId,orgCode:orgCode,status:&quot;1&quot;}).flushAsync();
  view.get(&quot;#dialogRole&quot;).show();

}
</ClientEvent>
              <Property name="caption">添加</Property>
              <Property name="icon">url(>skin>common/icons.gif) -120px -0px</Property>
            </ToolBarButton>
            <ToolBarButton>
              <ClientEvent name="onClick">var entitys = view.get(&quot;#dataSetPostRole&quot;).getData();
var selection = view.get(&quot;#postRoleGrid&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if (selection.length != 0) {
			jQuery.each(selection,function(i,item){
			entitys.remove(item);
		});
}</ClientEvent>
              <Property name="caption">删除</Property>
              <Property name="icon">url(>skin>common/icons.gif) -140px -0px</Property>
            </ToolBarButton>
          </ToolBar>
          <DataGrid id="postRoleGrid">
            <Property name="dataSet">dataSetPostRole</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="readOnly">true</Property>
            <RowNumColumn/>
            <RowSelectorColumn/>
            <DataColumn>
              <Property name="name">roleName</Property>
              <Property name="property">roleName</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="name">roleType</Property>
              <Property name="property">roleType</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="property">status</Property>
              <Property name="name">status</Property>
              <Editor/>
            </DataColumn>
          </DataGrid>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="dialogRole">
      <Property name="caption">角色选择</Property>
      <Property name="center">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">70%</Property>
      <Property name="height">90%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var dialog = view.get(&quot;#dialogRole&quot;);
var entitys = view.get(&quot;#dataSetPostRole&quot;).getData();
var selection = view.get(&quot;#roleMultiList&quot;).get(&quot;selection&quot;);
var selection2 = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var postId = selection2[0].get(&quot;id&quot;);
if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if (selection.length != 0) {
	jQuery.each(selection,function(i,item){
		//忽略已经存在的按钮
		var bool = true;
		entitys.each(function(entity){
			if(item.get(&quot;id&quot;) == entity.get(&quot;roleId&quot;)){
				bool = false;
				return true;
			}
		});
		if(bool){
			var entity = {
				roleId:item.get(&quot;id&quot;),
				postId:postId,
				roleName:item.get(&quot;roleName&quot;),
				roleType:item.get(&quot;roleType&quot;),
				status:item.get(&quot;status&quot;)
			};
			entitys.insert(entity);
		}
	});
	dialog.hide();
}</ClientEvent>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
          <Property name="caption">确定</Property>
        </Button>
      </Buttons>
      <Children>
        <Container id="multiList2">
          <Property name="hideMode">display</Property>
          <Property name="visible">true</Property>
          <FieldSet>
            <Property name="collapsed">true</Property>
            <Property name="buttonAlign">right</Property>
            <Property name="caption">查询</Property>
            <Buttons/>
            <Children>
              <AutoForm>
                <Property name="dataSet">dataSetRoleQuery</Property>
                <Property name="cols">*,*</Property>
                <Property name="labelAlign">right</Property>
                <AutoFormElement>
                  <Property name="name">roleName</Property>
                  <Property name="property">roleName</Property>
                  <Property name="showLabel">true</Property>
                  <Property name="trigger">triggerClear</Property>
                  <Editor/>
                </AutoFormElement>
                <Button id="roleMultiListSearch">
                  <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);
var postId=selection[0].get(&quot;id&quot;);
var orgLevel=selection[0].get(&quot;orgLevel&quot;);
var roleName=view.get(&quot;#dataSetRoleQuery&quot;).getData(&quot;#&quot;).get(&quot;roleName&quot;);
view.get(&quot;#dataSetUser&quot;).set(&quot;parameter&quot;, {&quot;postId&quot;:postId,&quot;roleName&quot;:roleName,&quot;orgLevel&quot;:orgLevel}).flushAsync();
</ClientEvent>
                  <Property name="caption">查询</Property>
                </Button>
              </AutoForm>
            </Children>
          </FieldSet>
          <DataGrid id="roleMultiList">
            <Property name="dataSet">dataSetRole</Property>
            <Property name="showHeader">true</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="rowSelectionProperty">selectFlag</Property>
            <Property name="highlightCurrentRow">false</Property>
            <RowNumColumn/>
            <RowSelectorColumn/>
            <DataColumn>
              <Property name="name">roleName</Property>
              <Property name="property">roleName</Property>
              <Property name="readOnly">true</Property>
              <Editor/>
            </DataColumn>
            <DataColumn>
              <Property name="name">roleType</Property>
              <Property name="property">roleType</Property>
              <Editor/>
            </DataColumn>
          </DataGrid>
          <ToolBar id="multiListPilot2" layoutConstraint="bottom">
            <Property name="hideMode">display</Property>
            <DataPilot>
              <Property name="itemCodes">pages</Property>
              <Property name="dataSet">dataSetRole</Property>
            </DataPilot>
          </ToolBar>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="addDialogSysPostBusiness">
      <ClientEvent name="onClose">view.get(&quot;#dataTypeSysUserPost&quot;).getData().cancel();
view.get(&quot;#addDialogSysPostRole&quot;).hide();</ClientEvent>
      <Property name="caption">维护业务条线</Property>
      <Property name="center">true</Property>
      <Property name="border">normal</Property>
      <Property name="minimizeable">true</Property>
      <Property name="maximizeable">true</Property>
      <Property name="modal">true</Property>
      <Property name="width">80%</Property>
      <Property name="height">90%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var action = view.get(&quot;#savePostBusinessAction&quot;);
var dialog=view.get(&quot;#addDialogSysPostBusiness&quot;);
action.execute(function(){
	dialog.hide();
});
</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">view.get(&quot;#dataSetPostBusiness&quot;).getData().cancel();
view.get(&quot;#addDialogSysPostBusiness&quot;).hide();
              	
		  </ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <Container>
          <Property name="contentOverflowY">auto</Property>
          <ToolBar id="addPostBusiness">
            <ToolBarButton>
              <ClientEvent name="onClick">var selection = view.get(&quot;#dataGridSysPost&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if(selection.length>1){
	dorado.MessageBox.alert(&quot;只能对一条记录维护业务条线！&quot;);
}else if (selection.length == 1) {
  view.get(&quot;#dataSetBizLine&quot;).set(&quot;parameter&quot;,{parentBusilineId: &quot;0&quot;}).flushAsync(function(){
  	    	view.get(&quot;#addBizLineDialog&quot;).show();
  });
}
</ClientEvent>
              <Property name="caption">添加</Property>
              <Property name="icon">url(>skin>common/icons.gif) -120px -0px</Property>
            </ToolBarButton>
            <ToolBarButton>
              <ClientEvent name="onClick">var entitys = view.get(&quot;#dataSetPostBusiness&quot;).getData();
var selection = view.get(&quot;#postBusinessGrid&quot;).get(&quot;selection&quot;);

if(selection.length==0){
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);
}else if (selection.length != 0) {
			jQuery.each(selection,function(i,item){
			entitys.remove(item);
		});
}</ClientEvent>
              <Property name="caption">删除</Property>
              <Property name="icon">url(>skin>common/icons.gif) -140px -0px</Property>
            </ToolBarButton>
          </ToolBar>
          <DataGrid id="postBusinessGrid">
            <Property name="dataSet">dataSetPostBusiness</Property>
            <Property name="selectionMode">multiRows</Property>
            <Property name="readOnly">true</Property>
            <RowNumColumn/>
            <RowSelectorColumn/>
            <DataColumn name="busilineName">
              <Property name="property">busilineName</Property>
            </DataColumn>
          </DataGrid>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <Dialog id="addBizLineDialog">
      <Property name="center">true</Property>
      <Property name="caption">选择业务条线</Property>
      <Property name="modal">true</Property>
      <Property name="width">70%</Property>
      <Property name="height">80%</Property>
      <Buttons>
        <Button>
          <ClientEvent name="onClick">var selection = view.get('#dataGridSysPost').get('selection');&#xD;
var nodes=view.get('#busiLineTree').getCheckedNodes();&#xD;
if(nodes.length==0){&#xD;
	dorado.MessageBox.alert(&quot;请选择记录！&quot;);&#xD;
}else if (nodes.length != 0) {&#xD;
		var dimenDateList=view.get('#dataSetPostBusiness').getData();&#xD;
		jQuery.each(nodes,function(i,node){&#xD;
			var isexists=false;&#xD;
			var bizlineId=node.get('data').get('id');&#xD;
			var bizlineName=node.get('data').get('busilineName');&#xD;
			dimenDateList.each(function(entity){&#xD;
				var id=entity.get('busilineId');&#xD;
				if(bizlineId==id){&#xD;
					isexists=true;&#xD;
				}&#xD;
			});&#xD;
			if(!isexists){&#xD;
				var entity={&#xD;
					busilineId:bizlineId,&#xD;
					busilineName:bizlineName,&#xD;
					objBusilineType:'2',&#xD;
					objId:selection[0].get('id'),&#xD;
					objCode:selection[0].get('postCode')&#xD;
				}&#xD;
				dimenDateList.insert(entity);&#xD;
			}&#xD;
		});&#xD;
		view.get(&quot;#addBizLineDialog&quot;).hide();&#xD;
}&#xD;
</ClientEvent>
          <Property name="caption">确定</Property>
          <Property name="icon">url(>skin>common/icons.gif) -20px -0px</Property>
        </Button>
        <Button>
          <ClientEvent name="onClick">view.get(&quot;#addBizLineDialog&quot;).hide();&#xD;
</ClientEvent>
          <Property name="caption">取消</Property>
          <Property name="icon">url(>skin>common/icons.gif) -180px -160px</Property>
        </Button>
      </Buttons>
      <Children>
        <Container>
          <DataTreeGrid id="busiLineTree">
            <Property name="dataSet">dataSetBizLine</Property>
            <Property name="currentNodeDataPath">CURRENT_NODE</Property>
            <Property name="treeColumn">busilineCode</Property>
            <Property name="readOnly">true</Property>
            <Property name="selectionMode">multiRows</Property>
            <BindingConfigs>
              <BindingConfig>
                <Property name="childrenProperty">children</Property>
                <Property name="labelProperty">busilineCode</Property>
                <Property name="recursive">true</Property>
                <Property name="expandedIcon">>icons/layers.png</Property>
                <Property name="icon">>icons/layers.png</Property>
                <Property name="checkable">true</Property>
                <Property name="autoCheckChildren">false</Property>
              </BindingConfig>
            </BindingConfigs>
            <Columns>
              <DataColumn name="busilineCode" property="busilineCode">
                <Property name="readOnly">true</Property>
              </DataColumn>
              <DataColumn name="busilineName" property="busilineName">
                <Property name="readOnly">true</Property>
              </DataColumn>
              <DataColumn name="busilineDesc" property="busilineDesc">
                <Property name="readOnly">true</Property>
              </DataColumn>
            </Columns>
          </DataTreeGrid>
        </Container>
      </Children>
      <Tools/>
    </Dialog>
    <AjaxAction id="delAction">
      <Property name="service">sysPostAction#invalidPost</Property>
    </AjaxAction>
    <AjaxAction id="checkCode">
      <Property name="service">sysPostAction#checkCode</Property>
    </AjaxAction>
    <UpdateAction id="savePostBusinessAction">
      <Property name="executingMessage">正在处理...</Property>
      <Property name="successMessage">操作成功</Property>
      <Property name="dataResolver">sysObjBusinessAction#saveSysObjBusinesss</Property>
      <Property name="async">true</Property>
      <Property name="modal">false</Property>
      <UpdateItem>
        <Property name="dataSet">dataSetPostBusiness</Property>
      </UpdateItem>
    </UpdateAction>
  </View>
</ViewConfig>
